import{p as T,r as k,c as b}from"./index-CNtIdQN-.js";const I=["preset","imported","generated"];class w{constructor({id:e=null,name:n="",description:i="",category:s="imported",source:l="",enabled:h=!0,wordCardIds:f=[],createdAt:A=new Date,updatedAt:g=new Date}={}){this.id=e||this.generateId(),this.name=n,this.description=i,this.category=s,this.source=l,this.enabled=h,this.wordCardIds=Array.isArray(f)?f:[],this.createdAt=A,this.updatedAt=g,this.validate()}generateId(){return`deck-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}validate(){const e=[];if((!this.name||this.name.trim().length===0)&&e.push("Deck name is required and cannot be empty"),this.name&&this.name.length>100&&e.push("Deck name must be 100 characters or less"),this.description&&this.description.length>500&&e.push("Deck description must be 500 characters or less"),I.includes(this.category)||e.push(`Deck category must be one of: ${I.join(", ")}`),e.length>0)throw new Error(`Deck validation failed: ${e.join("; ")}`)}get totalCards(){return this.wordCardIds.length}addWordCard(e){return this.wordCardIds.includes(e)||(this.wordCardIds.push(e),this.updatedAt=new Date),this}removeWordCard(e){return this.wordCardIds=this.wordCardIds.filter(n=>n!==e),this.updatedAt=new Date,this}toggle(){return this.enabled=!this.enabled,this.updatedAt=new Date,this}updateName(e){return this.name=e,this.updatedAt=new Date,this.validate(),this}updateDescription(e){return this.description=e,this.updatedAt=new Date,this.validate(),this}toJSON(){return{id:this.id,name:this.name,description:this.description,category:this.category,source:this.source,enabled:this.enabled,wordCardIds:this.wordCardIds,totalCards:this.totalCards,createdAt:this.createdAt.toISOString(),updatedAt:this.updatedAt.toISOString()}}static fromJSON(e){return new w({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)})}static createPresetDeck(e,n,i,s=[]){return new w({name:e,description:n,category:"preset",source:i,wordCardIds:s.map(h=>h.id)})}static createImportedDeck(e,n,i=[]){return new w({name:e,description:n,category:"imported",source:"user-upload",wordCardIds:i.map(l=>l.id)})}static createGeneratedDeck(e,n,i,s=[]){return new w({name:e,description:n,category:"generated",source:i,wordCardIds:s.map(h=>h.id)})}}const j=["noun","verb","adjective","adverb","pronoun","preposition","conjunction","interjection","article"],E=["new","easy","medium","hard"],N=["A1","A2","B1","B2","C1","C2"];class v{constructor({id:e=null,word:n="",translation:i="",partOfSpeech:s="noun",hint:l=null,audioUrl:h=null,difficulty:f="new",cefr:A=null,tags:g=[],createdAt:O=new Date,updatedAt:S=new Date}={}){this.id=e||this.generateId(),this.word=n,this.translation=i,this.partOfSpeech=s,this.hint=l,this.audioUrl=h,this.difficulty=f,this.cefr=A,this.tags=Array.isArray(g)?g:[],this.createdAt=O,this.updatedAt=S,this.validate()}generateId(){return`word-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}validate(){const e=[];if((!this.word||this.word.trim().length===0)&&e.push("Word is required and cannot be empty"),(!this.translation||this.translation.trim().length===0)&&e.push("Translation is required and cannot be empty"),j.includes(this.partOfSpeech)||e.push(`Part of speech must be one of: ${j.join(", ")}`),this.hint&&this.hint.length>200&&e.push("Hint must be 200 characters or less"),E.includes(this.difficulty)||e.push(`Difficulty must be one of: ${E.join(", ")}`),this.cefr&&!N.includes(this.cefr)&&e.push(`CEFR level must be one of: ${N.join(", ")}`),this.audioUrl&&!this.isValidUrl(this.audioUrl)&&e.push("Audio URL must be a valid URL"),e.length>0)throw new Error(`WordCard validation failed: ${e.join("; ")}`)}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}updateTranslation(e){return this.translation=e,this.updatedAt=new Date,this.validate(),this}updateDifficulty(e){return this.difficulty=e,this.updatedAt=new Date,this.validate(),this}addTag(e){return this.tags.includes(e)||(this.tags.push(e),this.updatedAt=new Date),this}removeTag(e){return this.tags=this.tags.filter(n=>n!==e),this.updatedAt=new Date,this}toJSON(){return{id:this.id,word:this.word,translation:this.translation,partOfSpeech:this.partOfSpeech,hint:this.hint,audioUrl:this.audioUrl,difficulty:this.difficulty,cefr:this.cefr,tags:this.tags,createdAt:this.createdAt.toISOString(),updatedAt:this.updatedAt.toISOString()}}static fromJSON(e){return new v({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)})}static createFromCSV(e){var n,i,s;return new v({word:(n=e.word)==null?void 0:n.trim(),translation:(i=e.translation)==null?void 0:i.trim(),partOfSpeech:e.part_of_speech||e.partOfSpeech||"noun",hint:((s=e.hint)==null?void 0:s.trim())||null,cefr:e.cefr||e.level||null,tags:e.tags?e.tags.split(",").map(l=>l.trim()):[]})}}const q=T("decks",()=>{const c=k(new Map),e=k(new Map),n=b(()=>Array.from(c.value.values())),i=b(()=>n.value.filter(r=>r.enabled)),s=b(()=>r=>{const t=c.value.get(r);if(!t)return null;const a=t.wordCardIds.map(o=>e.value.get(o)).filter(Boolean);return{...t,wordCards:a}}),l=b(()=>i.value.map(r=>{const t=r.wordCardIds.map(d=>e.value.get(d)).filter(Boolean),a=t.filter(d=>d.difficulty==="new"),o=t.filter(d=>d.difficulty!=="new"&&Math.random()>.7);return{id:r.id,name:r.name,newCards:a.length,reviewsDue:o.length,totalAvailable:t.length}}).filter(r=>r.totalAvailable>0));function h(r){try{const t=new w(r);return c.value.set(t.id,t),S(),{success:!0,deck:t}}catch(t){return{success:!1,errors:[t.message]}}}function f(r){try{const t=new v(r);return e.value.set(t.id,t),D(),{success:!0,wordCard:t}}catch(t){return{success:!1,errors:[t.message]}}}function A(r,t){try{const a=c.value.get(r);return a?(t.name!==void 0&&a.updateName(t.name),t.description!==void 0&&a.updateDescription(t.description),t.enabled!==void 0&&(a.enabled=t.enabled,a.updatedAt=new Date),c.value.set(r,a),S(),{success:!0}):{success:!1,errors:["Deck not found"]}}catch(a){return{success:!1,errors:[a.message]}}}function g(r){const t=c.value.get(r);return t?(t.wordCardIds.forEach(a=>{e.value.delete(a)}),c.value.delete(r),S(),D(),{success:!0,message:"Deck deleted successfully"}):{success:!1,message:"Deck not found"}}function O(r){try{const t=r.split(`
`).filter(u=>u.trim());if(t.length<2)return{success:!1,preview:{errors:["CSV must have header and data rows"]}};const a=t[0].split(",").map(u=>u.trim().toLowerCase()),d=["word","translation"].filter(u=>!a.includes(u));if(d.length>0)return{success:!1,preview:{errors:[`Missing required columns: ${d.join(", ")}`]}};const p=[],y=[];for(let u=1;u<t.length;u++){const U=t[u].split(",").map(m=>m.trim()),C={};a.forEach((m,$)=>{C[m]=U[$]||""});try{const m=v.createFromCSV(C);y.push(m)}catch(m){p.push({row:u,field:"general",message:m.message})}}return{success:!0,preview:{validRows:y.length,invalidRows:p.length,sampleCards:y.slice(0,3),errors:p}}}catch(t){return{success:!1,preview:{errors:[t.message]}}}}function S(){const r=Array.from(c.value.values()).map(t=>t.toJSON());localStorage.setItem("word-app-decks",JSON.stringify(r))}function D(){const r=Array.from(e.value.values()).map(t=>t.toJSON());localStorage.setItem("word-app-cards",JSON.stringify(r))}function F(){const r=JSON.parse(localStorage.getItem("word-app-decks")||"[]");c.value.clear(),r.forEach(a=>{const o=w.fromJSON(a);c.value.set(o.id,o)});const t=JSON.parse(localStorage.getItem("word-app-cards")||"[]");e.value.clear(),t.forEach(a=>{const o=v.fromJSON(a);e.value.set(o.id,o)})}function J(){if(c.value.size>0)return;const t=[{word:"bonjour",translation:"hello",partOfSpeech:"interjection",hint:"common greeting",cefr:"A1"},{word:"merci",translation:"thank you",partOfSpeech:"interjection",hint:"polite expression",cefr:"A1"},{word:"au revoir",translation:"goodbye",partOfSpeech:"interjection",hint:"farewell",cefr:"A1"},{word:"oui",translation:"yes",partOfSpeech:"adverb",hint:"affirmative response",cefr:"A1"},{word:"non",translation:"no",partOfSpeech:"adverb",hint:"negative response",cefr:"A1"},{word:"chat",translation:"cat",partOfSpeech:"noun",hint:"domestic feline",cefr:"A1"},{word:"chien",translation:"dog",partOfSpeech:"noun",hint:"man's best friend",cefr:"A1"},{word:"eau",translation:"water",partOfSpeech:"noun",hint:"essential liquid",cefr:"A1"},{word:"pain",translation:"bread",partOfSpeech:"noun",hint:"daily staple food",cefr:"A1"},{word:"livre",translation:"book",partOfSpeech:"noun",hint:"for reading",cefr:"A1"},{word:"maison",translation:"house",partOfSpeech:"noun",hint:"place to live",cefr:"A1"},{word:"voiture",translation:"car",partOfSpeech:"noun",hint:"vehicle for transport",cefr:"A1"},{word:"école",translation:"school",partOfSpeech:"noun",hint:"place of learning",cefr:"A1"},{word:"ami",translation:"friend",partOfSpeech:"noun",hint:"close companion",cefr:"A1"},{word:"famille",translation:"family",partOfSpeech:"noun",hint:"relatives together",cefr:"A1"},{word:"rouge",translation:"red",partOfSpeech:"adjective",hint:"color like blood",cefr:"A1"},{word:"bleu",translation:"blue",partOfSpeech:"adjective",hint:"color like sky",cefr:"A1"},{word:"vert",translation:"green",partOfSpeech:"adjective",hint:"color like grass",cefr:"A1"},{word:"grand",translation:"big",partOfSpeech:"adjective",hint:"opposite of small",cefr:"A1"},{word:"petit",translation:"small",partOfSpeech:"adjective",hint:"opposite of big",cefr:"A1"},{word:"être",translation:"to be",partOfSpeech:"verb",hint:"most important verb",cefr:"A1"},{word:"avoir",translation:"to have",partOfSpeech:"verb",hint:"auxiliary verb",cefr:"A1"},{word:"aller",translation:"to go",partOfSpeech:"verb",hint:"movement verb",cefr:"A1"},{word:"faire",translation:"to do/make",partOfSpeech:"verb",hint:"action verb",cefr:"A1"},{word:"voir",translation:"to see",partOfSpeech:"verb",hint:"perception verb",cefr:"A1"},{word:"un",translation:"one",partOfSpeech:"number",hint:"first number",cefr:"A1"},{word:"deux",translation:"two",partOfSpeech:"number",hint:"second number",cefr:"A1"},{word:"trois",translation:"three",partOfSpeech:"number",hint:"third number",cefr:"A1"},{word:"aujourd'hui",translation:"today",partOfSpeech:"adverb",hint:"this day",cefr:"A1"},{word:"demain",translation:"tomorrow",partOfSpeech:"adverb",hint:"next day",cefr:"A1"}].map(d=>{const p=f(d);return p.success?p.wordCard.id:null}).filter(Boolean);h({name:"French A1 - Essential Vocabulary",description:"Complete set of 30 essential French words for absolute beginners",category:"preset",source:"french-a1-complete",wordCardIds:t});const o=[{word:"salut",translation:"hi/bye",partOfSpeech:"interjection",hint:"informal greeting",cefr:"A1"},{word:"bonsoir",translation:"good evening",partOfSpeech:"interjection",hint:"evening greeting",cefr:"A1"},{word:"s'il vous plaît",translation:"please",partOfSpeech:"interjection",hint:"polite request",cefr:"A1"},{word:"excusez-moi",translation:"excuse me",partOfSpeech:"interjection",hint:"polite interruption",cefr:"A1"},{word:"pardon",translation:"sorry",partOfSpeech:"interjection",hint:"apology",cefr:"A1"}].map(d=>{const p=f(d);return p.success?p.wordCard.id:null}).filter(Boolean);h({name:"French Greetings",description:"Polite expressions for social interactions",category:"preset",source:"french-greetings",wordCardIds:o,enabled:!1})}return{decks:n,enabledDecks:i,getDeckWithCards:s,getAvailableDecksForStudy:l,addDeck:h,addWordCard:f,updateDeckSettings:A,deleteDeck:g,importFromCSV:O,loadFromPersistence:F,initializeWithSampleData:J}});export{q as u};
